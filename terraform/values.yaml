dagster-user-deployments:
  enabled: true
  deployments:
    - name: "k8s-deployment"
      image:
        repository: "docker.io/library/fnhb-btch-stck-ppln"
        tag: v1.0.0
        pullPolicy: Never
      dagsterApiGrpcArgs:
        - "--module-name"
        - "finnhub_batch_stock_pipeline"
      port: 3030
      envConfigMaps:
        - name: pipeline-config
      envSecrets:
        - name: pipeline-secrets
      resources:
        limits:
          cpu: 500m
          memory: 2048Mi
        requests:
          cpu: 200m
          memory: 1024Mi
      includeConfigInLaunchedRuns:
        enabled: true

runLauncher:
  type: K8sRunLauncher
  config:
    k8sRunLauncher:
      imagePullPolicy: IfNotPresent
      volumes:
        - name: nfs-mount
          persistentVolumeClaim:
            claimName: nfs-pvc
      volumeMounts:
        - name: nfs-mount
          mountPath: /opt/dagster/dagster_home
      runK8sConfig:
        containerConfig: # raw config for the pod's main container
          resources:
            limits:
              cpu: 1500m
              memory: 7168Mi
            requests:
              cpu: 500m
              memory: 2048Mi
      envConfigMaps:
        - name: pipeline-config
      envSecrets:
        - name: pipeline-secrets



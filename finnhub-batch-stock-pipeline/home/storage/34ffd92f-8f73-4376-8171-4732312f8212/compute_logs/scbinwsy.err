[32m2024-05-31 13:32:53 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - LOGS_CAPTURED - Started capturing logs in process (pid: 436843).
[32m2024-05-31 13:32:53 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - STEP_START - Started execution of step "fact_tables".
24/05/31 13:32:55 WARN Utils: Your hostname, willowyboat-practicalda-8yoi5et7ep7 resolves to a loopback address: 127.0.0.1; using 10.0.5.2 instead (on interface eth0)
24/05/31 13:32:55 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
Ivy Default Cache set to: /home/gitpod/.ivy2/cache
The jars for the packages stored in: /home/gitpod/.ivy2/jars
io.delta#delta-spark_2.12 added as a dependency
org.apache.hadoop#hadoop-aws added as a dependency
org.apache.hadoop#hadoop-common added as a dependency
com.amazonaws#aws-java-sdk-bundle added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-1980f147-0b3a-4fe1-b969-81b526d1aef4;1.0
	confs: [default]
	found io.delta#delta-spark_2.12;3.1.0 in spark-list
	found io.delta#delta-storage;3.1.0 in central
	found org.antlr#antlr4-runtime;4.9.3 in central
	found org.apache.hadoop#hadoop-aws;3.3.4 in central
	found com.amazonaws#aws-java-sdk-bundle;1.12.262 in central
	found org.wildfly.openssl#wildfly-openssl;1.0.7.Final in central
	found org.apache.hadoop#hadoop-common;3.3.4 in central
	found org.apache.hadoop.thirdparty#hadoop-shaded-protobuf_3_7;1.1.1 in central
	found org.apache.hadoop#hadoop-annotations;3.3.4 in central
	found org.apache.hadoop.thirdparty#hadoop-shaded-guava;1.1.1 in central
	found com.google.guava#guava;27.0-jre in central
	found com.google.guava#failureaccess;1.0 in central
	found com.google.guava#listenablefuture;9999.0-empty-to-avoid-conflict-with-guava in central
	found com.google.code.findbugs#jsr305;3.0.2 in central
	found org.checkerframework#checker-qual;2.5.2 in central
	found com.google.j2objc#j2objc-annotations;1.1 in central
	found org.codehaus.mojo#animal-sniffer-annotations;1.17 in central
	found commons-cli#commons-cli;1.2 in central
	found org.apache.commons#commons-math3;3.1.1 in central
	found org.apache.httpcomponents#httpclient;4.5.13 in central
	found org.apache.httpcomponents#httpcore;4.4.13 in central
	found commons-logging#commons-logging;1.1.3 in central
	found commons-codec#commons-codec;1.15 in central
	found commons-io#commons-io;2.8.0 in central
	found commons-net#commons-net;3.6 in central
	found commons-collections#commons-collections;3.2.2 in central
	found javax.servlet#javax.servlet-api;3.1.0 in central
	found org.eclipse.jetty#jetty-server;9.4.43.v20210629 in central
	found org.eclipse.jetty#jetty-http;9.4.43.v20210629 in central
	found org.eclipse.jetty#jetty-util;9.4.43.v20210629 in central
	found org.eclipse.jetty#jetty-io;9.4.43.v20210629 in central
	found org.eclipse.jetty#jetty-servlet;9.4.43.v20210629 in central
	found org.eclipse.jetty#jetty-security;9.4.43.v20210629 in central
	found org.eclipse.jetty#jetty-util-ajax;9.4.43.v20210629 in central
	found org.eclipse.jetty#jetty-webapp;9.4.43.v20210629 in central
	found org.eclipse.jetty#jetty-xml;9.4.43.v20210629 in central
	found com.sun.jersey#jersey-core;1.19 in central
	found javax.ws.rs#jsr311-api;1.1.1 in central
	found com.sun.jersey#jersey-servlet;1.19 in central
	found com.sun.jersey#jersey-server;1.19 in central
	found com.sun.jersey#jersey-json;1.19 in central
	found org.codehaus.jettison#jettison;1.1 in central
	found com.sun.xml.bind#jaxb-impl;2.2.3-1 in central
	found javax.xml.bind#jaxb-api;2.2.11 in central
	found org.codehaus.jackson#jackson-core-asl;1.9.13 in central
	found org.codehaus.jackson#jackson-mapper-asl;1.9.13 in central
	found org.codehaus.jackson#jackson-jaxrs;1.9.13 in central
	found org.codehaus.jackson#jackson-xc;1.9.13 in central
	found ch.qos.reload4j#reload4j;1.2.22 in central
	found commons-beanutils#commons-beanutils;1.9.4 in central
	found org.apache.commons#commons-configuration2;2.1.1 in central
	found org.apache.commons#commons-lang3;3.12.0 in central
	found org.apache.commons#commons-text;1.4 in central
	found org.slf4j#slf4j-api;1.7.36 in central
	found org.slf4j#slf4j-reload4j;1.7.36 in central
	found org.apache.avro#avro;1.7.7 in central
	found com.thoughtworks.paranamer#paranamer;2.3 in central
	found org.xerial.snappy#snappy-java;1.1.8.2 in central
	found org.apache.commons#commons-compress;1.21 in central
	found com.google.re2j#re2j;1.1 in central
	found com.google.protobuf#protobuf-java;2.5.0 in central
	found com.google.code.gson#gson;2.8.9 in spark-list
	found org.apache.hadoop#hadoop-auth;3.3.4 in central
	found com.nimbusds#nimbus-jose-jwt;9.8.1 in central
	found com.github.stephenc.jcip#jcip-annotations;1.0-1 in central
	found net.minidev#json-smart;2.4.7 in central
	found net.minidev#accessors-smart;2.4.7 in central
	found org.ow2.asm#asm;5.0.4 in central
	found org.apache.zookeeper#zookeeper;3.5.6 in central
	found org.apache.zookeeper#zookeeper-jute;3.5.6 in central
	found org.apache.yetus#audience-annotations;0.5.0 in central
	found org.apache.curator#curator-framework;4.2.0 in central
	found org.apache.curator#curator-client;4.2.0 in central
	found org.apache.kerby#kerb-simplekdc;1.0.1 in central
	found org.apache.kerby#kerb-client;1.0.1 in central
	found org.apache.kerby#kerby-config;1.0.1 in central
	found org.apache.kerby#kerb-core;1.0.1 in central
	found org.apache.kerby#kerby-pkix;1.0.1 in central
	found org.apache.kerby#kerby-asn1;1.0.1 in central
	found org.apache.kerby#kerby-util;1.0.1 in central
	found org.apache.kerby#kerb-common;1.0.1 in central
	found org.apache.kerby#kerb-crypto;1.0.1 in central
	found org.apache.kerby#kerb-util;1.0.1 in central
	found org.apache.kerby#token-provider;1.0.1 in central
	found org.apache.kerby#kerb-admin;1.0.1 in central
	found org.apache.kerby#kerb-server;1.0.1 in central
	found org.apache.kerby#kerb-identity;1.0.1 in central
	found org.apache.kerby#kerby-xdr;1.0.1 in central
	found com.jcraft#jsch;0.1.55 in central
	found org.apache.curator#curator-recipes;4.2.0 in central
	found com.fasterxml.jackson.core#jackson-databind;2.12.7 in central
	found com.fasterxml.jackson.core#jackson-annotations;2.12.7 in central
	found com.fasterxml.jackson.core#jackson-core;2.12.7 in central
	found org.codehaus.woodstox#stax2-api;4.2.1 in central
	found com.fasterxml.woodstox#woodstox-core;5.3.0 in central
	found dnsjava#dnsjava;2.1.7 in central
	found jakarta.activation#jakarta.activation-api;1.2.1 in central
	found javax.servlet.jsp#jsp-api;2.1 in central
:: resolution report :: resolve 1547ms :: artifacts dl 53ms
	:: modules in use:
	ch.qos.reload4j#reload4j;1.2.22 from central in [default]
	com.amazonaws#aws-java-sdk-bundle;1.12.262 from central in [default]
	com.fasterxml.jackson.core#jackson-annotations;2.12.7 from central in [default]
	com.fasterxml.jackson.core#jackson-core;2.12.7 from central in [default]
	com.fasterxml.jackson.core#jackson-databind;2.12.7 from central in [default]
	com.fasterxml.woodstox#woodstox-core;5.3.0 from central in [default]
	com.github.stephenc.jcip#jcip-annotations;1.0-1 from central in [default]
	com.google.code.findbugs#jsr305;3.0.2 from central in [default]
	com.google.code.gson#gson;2.8.9 from spark-list in [default]
	com.google.guava#failureaccess;1.0 from central in [default]
	com.google.guava#guava;27.0-jre from central in [default]
	com.google.guava#listenablefuture;9999.0-empty-to-avoid-conflict-with-guava from central in [default]
	com.google.j2objc#j2objc-annotations;1.1 from central in [default]
	com.google.protobuf#protobuf-java;2.5.0 from central in [default]
	com.google.re2j#re2j;1.1 from central in [default]
	com.jcraft#jsch;0.1.55 from central in [default]
	com.nimbusds#nimbus-jose-jwt;9.8.1 from central in [default]
	com.sun.jersey#jersey-core;1.19 from central in [default]
	com.sun.jersey#jersey-json;1.19 from central in [default]
	com.sun.jersey#jersey-server;1.19 from central in [default]
	com.sun.jersey#jersey-servlet;1.19 from central in [default]
	com.sun.xml.bind#jaxb-impl;2.2.3-1 from central in [default]
	com.thoughtworks.paranamer#paranamer;2.3 from central in [default]
	commons-beanutils#commons-beanutils;1.9.4 from central in [default]
	commons-cli#commons-cli;1.2 from central in [default]
	commons-codec#commons-codec;1.15 from central in [default]
	commons-collections#commons-collections;3.2.2 from central in [default]
	commons-io#commons-io;2.8.0 from central in [default]
	commons-logging#commons-logging;1.1.3 from central in [default]
	commons-net#commons-net;3.6 from central in [default]
	dnsjava#dnsjava;2.1.7 from central in [default]
	io.delta#delta-spark_2.12;3.1.0 from spark-list in [default]
	io.delta#delta-storage;3.1.0 from central in [default]
	jakarta.activation#jakarta.activation-api;1.2.1 from central in [default]
	javax.servlet#javax.servlet-api;3.1.0 from central in [default]
	javax.servlet.jsp#jsp-api;2.1 from central in [default]
	javax.ws.rs#jsr311-api;1.1.1 from central in [default]
	javax.xml.bind#jaxb-api;2.2.11 from central in [default]
	net.minidev#accessors-smart;2.4.7 from central in [default]
	net.minidev#json-smart;2.4.7 from central in [default]
	org.antlr#antlr4-runtime;4.9.3 from central in [default]
	org.apache.avro#avro;1.7.7 from central in [default]
	org.apache.commons#commons-compress;1.21 from central in [default]
	org.apache.commons#commons-configuration2;2.1.1 from central in [default]
	org.apache.commons#commons-lang3;3.12.0 from central in [default]
	org.apache.commons#commons-math3;3.1.1 from central in [default]
	org.apache.commons#commons-text;1.4 from central in [default]
	org.apache.curator#curator-client;4.2.0 from central in [default]
	org.apache.curator#curator-framework;4.2.0 from central in [default]
	org.apache.curator#curator-recipes;4.2.0 from central in [default]
	org.apache.hadoop#hadoop-annotations;3.3.4 from central in [default]
	org.apache.hadoop#hadoop-auth;3.3.4 from central in [default]
	org.apache.hadoop#hadoop-aws;3.3.4 from central in [default]
	org.apache.hadoop#hadoop-common;3.3.4 from central in [default]
	org.apache.hadoop.thirdparty#hadoop-shaded-guava;1.1.1 from central in [default]
	org.apache.hadoop.thirdparty#hadoop-shaded-protobuf_3_7;1.1.1 from central in [default]
	org.apache.httpcomponents#httpclient;4.5.13 from central in [default]
	org.apache.httpcomponents#httpcore;4.4.13 from central in [default]
	org.apache.kerby#kerb-admin;1.0.1 from central in [default]
	org.apache.kerby#kerb-client;1.0.1 from central in [default]
	org.apache.kerby#kerb-common;1.0.1 from central in [default]
	org.apache.kerby#kerb-core;1.0.1 from central in [default]
	org.apache.kerby#kerb-crypto;1.0.1 from central in [default]
	org.apache.kerby#kerb-identity;1.0.1 from central in [default]
	org.apache.kerby#kerb-server;1.0.1 from central in [default]
	org.apache.kerby#kerb-simplekdc;1.0.1 from central in [default]
	org.apache.kerby#kerb-util;1.0.1 from central in [default]
	org.apache.kerby#kerby-asn1;1.0.1 from central in [default]
	org.apache.kerby#kerby-config;1.0.1 from central in [default]
	org.apache.kerby#kerby-pkix;1.0.1 from central in [default]
	org.apache.kerby#kerby-util;1.0.1 from central in [default]
	org.apache.kerby#kerby-xdr;1.0.1 from central in [default]
	org.apache.kerby#token-provider;1.0.1 from central in [default]
	org.apache.yetus#audience-annotations;0.5.0 from central in [default]
	org.apache.zookeeper#zookeeper;3.5.6 from central in [default]
	org.apache.zookeeper#zookeeper-jute;3.5.6 from central in [default]
	org.checkerframework#checker-qual;2.5.2 from central in [default]
	org.codehaus.jackson#jackson-core-asl;1.9.13 from central in [default]
	org.codehaus.jackson#jackson-jaxrs;1.9.13 from central in [default]
	org.codehaus.jackson#jackson-mapper-asl;1.9.13 from central in [default]
	org.codehaus.jackson#jackson-xc;1.9.13 from central in [default]
	org.codehaus.jettison#jettison;1.1 from central in [default]
	org.codehaus.mojo#animal-sniffer-annotations;1.17 from central in [default]
	org.codehaus.woodstox#stax2-api;4.2.1 from central in [default]
	org.eclipse.jetty#jetty-http;9.4.43.v20210629 from central in [default]
	org.eclipse.jetty#jetty-io;9.4.43.v20210629 from central in [default]
	org.eclipse.jetty#jetty-security;9.4.43.v20210629 from central in [default]
	org.eclipse.jetty#jetty-server;9.4.43.v20210629 from central in [default]
	org.eclipse.jetty#jetty-servlet;9.4.43.v20210629 from central in [default]
	org.eclipse.jetty#jetty-util;9.4.43.v20210629 from central in [default]
	org.eclipse.jetty#jetty-util-ajax;9.4.43.v20210629 from central in [default]
	org.eclipse.jetty#jetty-webapp;9.4.43.v20210629 from central in [default]
	org.eclipse.jetty#jetty-xml;9.4.43.v20210629 from central in [default]
	org.ow2.asm#asm;5.0.4 from central in [default]
	org.slf4j#slf4j-api;1.7.36 from central in [default]
	org.slf4j#slf4j-reload4j;1.7.36 from central in [default]
	org.wildfly.openssl#wildfly-openssl;1.0.7.Final from central in [default]
	org.xerial.snappy#snappy-java;1.1.8.2 from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   98  |   0   |   0   |   0   ||   98  |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-1980f147-0b3a-4fe1-b969-81b526d1aef4
	confs: [default]
	14 artifacts copied, 84 already retrieved (7605kB/42ms)
24/05/31 13:32:57 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[32m2024-05-31 13:33:02 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - fact_tables - Loading S3 object from: s3a://dagster-api/staging/2024-05-31/metric
24/05/31 13:33:03 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties
[32m2024-05-31 13:33:08 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - LOADED_INPUT - Loaded input "metric" using input manager "s3_prqt_io_manager", from output "metric" of step "spark_operator.merge_and_analyze"
[32m2024-05-31 13:33:08 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - fact_tables - Loading S3 object from: s3a://dagster-api/staging/2024-05-31/series
[32m2024-05-31 13:33:08 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - LOADED_INPUT - Loaded input "series" using input manager "s3_prqt_io_manager", from output "series" of step "spark_operator.merge_and_analyze"
[32m2024-05-31 13:33:08 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - STEP_INPUT - Got input "metric" of type "DataFrame". (Type check passed).
[32m2024-05-31 13:33:08 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - STEP_INPUT - Got input "series" of type "DataFrame". (Type check passed).
[32m2024-05-31 13:33:16 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - fact_tables - <bound method StructType.simpleString of StructType([StructField('10DayAverageTradingVolume', FloatType(), True), StructField('13WeekPriceReturnDaily', FloatType(), True), StructField('26WeekPriceReturnDaily', FloatType(), True), StructField('3MonthADReturnStd', FloatType(), True), StructField('3MonthAverageTradingVolume', FloatType(), True), StructField('52WeekHigh', FloatType(), True), StructField('52WeekHighDate', FloatType(), True), StructField('52WeekLow', FloatType(), True), StructField('52WeekLowDate', FloatType(), True), StructField('52WeekPriceReturnDaily', FloatType(), True), StructField('5DayPriceReturnDaily', FloatType(), True), StructField('assetTurnoverAnnual', FloatType(), True), StructField('assetTurnoverTTM', FloatType(), True), StructField('beta', FloatType(), True), StructField('bookValuePerShareAnnual', FloatType(), True), StructField('bookValuePerShareQuarterly', FloatType(), True), StructField('bookValueShareGrowth5Y', FloatType(), True), StructField('capexCagr5Y', FloatType(), True), StructField('cashFlowPerShareAnnual', FloatType(), True), StructField('cashFlowPerShareQuarterly', FloatType(), True), StructField('cashFlowPerShareTTM', FloatType(), True), StructField('cashPerSharePerShareAnnual', FloatType(), True), StructField('cashPerSharePerShareQuarterly', FloatType(), True), StructField('currentDividendYieldTTM', FloatType(), True), StructField('currentRatioAnnual', FloatType(), True), StructField('currentRatioQuarterly', FloatType(), True), StructField('dividendPerShareAnnual', FloatType(), True), StructField('dividendPerShareTTM', FloatType(), True), StructField('ebitdPerShareAnnual', FloatType(), True), StructField('ebitdPerShareTTM', FloatType(), True), StructField('ebitdaCagr5Y', FloatType(), True), StructField('ebitdaInterimCagr5Y', FloatType(), True), StructField('enterpriseValue', FloatType(), True), StructField('epsAnnual', FloatType(), True), StructField('epsBasicExclExtraItemsAnnual', FloatType(), True), StructField('epsBasicExclExtraItemsTTM', FloatType(), True), StructField('epsExclExtraItemsAnnual', FloatType(), True), StructField('epsExclExtraItemsTTM', FloatType(), True), StructField('epsGrowth3Y', FloatType(), True), StructField('epsGrowth5Y', FloatType(), True), StructField('epsGrowthQuarterlyYoy', FloatType(), True), StructField('epsGrowthTTMYoy', FloatType(), True), StructField('epsInclExtraItemsAnnual', FloatType(), True), StructField('epsInclExtraItemsTTM', FloatType(), True), StructField('epsNormalizedAnnual', FloatType(), True), StructField('epsTTM', FloatType(), True), StructField('focfCagr5Y', FloatType(), True), StructField('grossMarginAnnual', FloatType(), True), StructField('grossMarginTTM', FloatType(), True), StructField('inventoryTurnoverTTM', FloatType(), True), StructField('longTermDebt/equityAnnual', FloatType(), True), StructField('longTermDebt/equityQuarterly', FloatType(), True), StructField('marketCapitalization', FloatType(), True), StructField('monthToDatePriceReturnDaily', FloatType(), True), StructField('netIncomeEmployeeAnnual', FloatType(), True), StructField('netIncomeEmployeeTTM', FloatType(), True), StructField('netInterestCoverageAnnual', FloatType(), True), StructField('netInterestCoverageTTM', FloatType(), True), StructField('netProfitMargin5Y', FloatType(), True), StructField('netProfitMarginAnnual', FloatType(), True), StructField('netProfitMarginTTM', FloatType(), True), StructField('operatingMargin5Y', FloatType(), True), StructField('operatingMarginAnnual', FloatType(), True), StructField('operatingMarginTTM', FloatType(), True), StructField('pbAnnual', FloatType(), True), StructField('pbQuarterly', FloatType(), True), StructField('pcfShareAnnual', FloatType(), True), StructField('pcfShareTTM', FloatType(), True), StructField('peAnnual', FloatType(), True), StructField('peBasicExclExtraTTM', FloatType(), True), StructField('peExclExtraTTM', FloatType(), True), StructField('peInclExtraTTM', FloatType(), True), StructField('peNormalizedAnnual', FloatType(), True), StructField('peTTM', FloatType(), True), StructField('pretaxMargin5Y', FloatType(), True), StructField('pretaxMarginAnnual', FloatType(), True), StructField('pretaxMarginTTM', FloatType(), True), StructField('priceRelativeToS&P50013Week', FloatType(), True), StructField('priceRelativeToS&P50026Week', FloatType(), True), StructField('priceRelativeToS&P5004Week', FloatType(), True), StructField('priceRelativeToS&P50052Week', FloatType(), True), StructField('priceRelativeToS&P500Ytd', FloatType(), True), StructField('psAnnual', FloatType(), True), StructField('psTTM', FloatType(), True), StructField('ptbvAnnual', FloatType(), True), StructField('ptbvQuarterly', FloatType(), True), StructField('quickRatioAnnual', FloatType(), True), StructField('quickRatioQuarterly', FloatType(), True), StructField('receivablesTurnoverAnnual', FloatType(), True), StructField('receivablesTurnoverTTM', FloatType(), True), StructField('revenueEmployeeAnnual', FloatType(), True), StructField('revenueEmployeeTTM', FloatType(), True), StructField('revenueGrowth3Y', FloatType(), True), StructField('revenueGrowth5Y', FloatType(), True), StructField('revenueGrowthQuarterlyYoy', FloatType(), True), StructField('revenueGrowthTTMYoy', FloatType(), True), StructField('revenuePerShareAnnual', FloatType(), True), StructField('revenuePerShareTTM', FloatType(), True), StructField('revenueShareGrowth5Y', FloatType(), True), StructField('roa5Y', FloatType(), True), StructField('roaRfy', FloatType(), True), StructField('roaTTM', FloatType(), True), StructField('roe5Y', FloatType(), True), StructField('roeRfy', FloatType(), True), StructField('roeTTM', FloatType(), True), StructField('roi5Y', FloatType(), True), StructField('roiAnnual', FloatType(), True), StructField('roiTTM', FloatType(), True), StructField('tangibleBookValuePerShareAnnual', FloatType(), True), StructField('tangibleBookValuePerShareQuarterly', FloatType(), True), StructField('tbvCagr5Y', FloatType(), True), StructField('totalDebt/totalEquityAnnual', FloatType(), True), StructField('totalDebt/totalEquityQuarterly', FloatType(), True), StructField('yearToDatePriceReturnDaily', FloatType(), True), StructField('symbol', StringType(), True), StructField('currentEv/freeCashFlowAnnual', FloatType(), True), StructField('currentEv/freeCashFlowTTM', FloatType(), True), StructField('dividendGrowthRate5Y', FloatType(), True), StructField('dividendYieldIndicatedAnnual', FloatType(), True), StructField('grossMargin5Y', FloatType(), True), StructField('inventoryTurnoverAnnual', FloatType(), True), StructField('netMarginGrowth5Y', FloatType(), True), StructField('payoutRatioAnnual', FloatType(), True), StructField('payoutRatioTTM', FloatType(), True), StructField('peExclExtraAnnual', FloatType(), True), StructField('pfcfShareAnnual', FloatType(), True), StructField('pfcfShareTTM', FloatType(), True)])>
[32m2024-05-31 13:33:16 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - fact_tables - <bound method StructType.simpleString of StructType([StructField('symbol', StringType(), True), StructField('date', DateType(), True), StructField('quarterly.assetTurnoverTTM', FloatType(), True), StructField('quarterly.bookValue', FloatType(), True), StructField('quarterly.cashRatio', FloatType(), True), StructField('quarterly.currentRatio', FloatType(), True), StructField('quarterly.ebitPerShare', FloatType(), True), StructField('quarterly.eps', FloatType(), True), StructField('quarterly.ev', FloatType(), True), StructField('quarterly.fcfMargin', FloatType(), True), StructField('quarterly.fcfPerShareTTM', FloatType(), True), StructField('quarterly.grossMargin', FloatType(), True), StructField('quarterly.inventoryTurnoverTTM', FloatType(), True), StructField('quarterly.longtermDebtTotalAsset', FloatType(), True), StructField('quarterly.longtermDebtTotalCapital', FloatType(), True), StructField('quarterly.longtermDebtTotalEquity', FloatType(), True), StructField('quarterly.netDebtToTotalCapital', FloatType(), True), StructField('quarterly.netDebtToTotalEquity', FloatType(), True), StructField('quarterly.netMargin', FloatType(), True), StructField('quarterly.operatingMargin', FloatType(), True), StructField('quarterly.pb', FloatType(), True), StructField('quarterly.pretaxMargin', FloatType(), True), StructField('quarterly.psTTM', FloatType(), True), StructField('quarterly.ptbv', FloatType(), True), StructField('quarterly.quickRatio', FloatType(), True), StructField('quarterly.receivablesTurnoverTTM', FloatType(), True), StructField('quarterly.roaTTM', FloatType(), True), StructField('quarterly.roeTTM', FloatType(), True), StructField('quarterly.roicTTM', FloatType(), True), StructField('quarterly.rotcTTM', FloatType(), True), StructField('quarterly.salesPerShare', FloatType(), True), StructField('quarterly.sgaToSale', FloatType(), True), StructField('quarterly.tangibleBookValue', FloatType(), True), StructField('quarterly.totalDebtToEquity', FloatType(), True), StructField('quarterly.totalDebtToTotalAsset', FloatType(), True), StructField('quarterly.totalDebtToTotalCapital', FloatType(), True), StructField('quarterly.totalRatio', FloatType(), True), StructField('annual.bookValue', FloatType(), True), StructField('annual.cashRatio', FloatType(), True), StructField('annual.currentRatio', FloatType(), True), StructField('annual.ebitPerShare', FloatType(), True), StructField('annual.eps', FloatType(), True), StructField('annual.ev', FloatType(), True), StructField('annual.grossMargin', FloatType(), True), StructField('annual.longtermDebtTotalAsset', FloatType(), True), StructField('annual.longtermDebtTotalCapital', FloatType(), True), StructField('annual.longtermDebtTotalEquity', FloatType(), True), StructField('annual.netDebtToTotalCapital', FloatType(), True), StructField('annual.netDebtToTotalEquity', FloatType(), True), StructField('annual.netMargin', FloatType(), True), StructField('annual.operatingMargin', FloatType(), True), StructField('annual.pb', FloatType(), True), StructField('annual.pe', FloatType(), True), StructField('annual.pretaxMargin', FloatType(), True), StructField('annual.ps', FloatType(), True), StructField('annual.ptbv', FloatType(), True), StructField('annual.quickRatio', FloatType(), True), StructField('annual.receivablesTurnover', FloatType(), True), StructField('annual.roa', FloatType(), True), StructField('annual.roe', FloatType(), True), StructField('annual.roic', FloatType(), True), StructField('annual.rotc', FloatType(), True), StructField('annual.salesPerShare', FloatType(), True), StructField('annual.sgaToSale', FloatType(), True), StructField('annual.tangibleBookValue', FloatType(), True), StructField('annual.totalDebtToEquity', FloatType(), True), StructField('annual.totalDebtToTotalAsset', FloatType(), True), StructField('annual.totalDebtToTotalCapital', FloatType(), True), StructField('quarterly.payoutRatioTTM', FloatType(), True), StructField('quarterly.peTTM', FloatType(), True), StructField('quarterly.pfcfTTM', FloatType(), True), StructField('annual.fcfMargin', FloatType(), True), StructField('annual.inventoryTurnover', FloatType(), True), StructField('annual.payoutRatio', FloatType(), True), StructField('annual.pfcf', FloatType(), True)])>
24/05/31 13:33:17 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
[Stage 4:>                                                        (0 + 16) / 50][Stage 4:=================>                                      (16 + 16) / 50][Stage 4:=================>                                      (16 + 17) / 50][Stage 4:=================================================>       (43 + 7) / 50]                                                                                [Stage 10:>                                                       (0 + 10) / 10]                                                                                [32m2024-05-31 13:33:24 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - STEP_OUTPUT - Yielded output "metric_fact" of type "Table". (Type check passed).
[32m2024-05-31 13:33:24 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - fact_tables - IO manager mode overridden with the asset metadata mode, overwrite -> append
[32m2024-05-31 13:33:24 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - fact_tables - Writing with mode: append
[32m2024-05-31 13:33:24 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - ASSET_MATERIALIZATION - Materialized value metric_fact.
[32m2024-05-31 13:33:24 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - HANDLED_OUTPUT - Handled output "metric_fact" using IO manager "delta_lake_arrow_io_manager"
[32m2024-05-31 13:33:24 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - STEP_OUTPUT - Yielded output "series_fact" of type "Table". (Type check passed).
[32m2024-05-31 13:33:24 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - fact_tables - IO manager mode overridden with the asset metadata mode, overwrite -> append
[32m2024-05-31 13:33:24 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - fact_tables - Writing with mode: append
[32m2024-05-31 13:33:24 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - ASSET_MATERIALIZATION - Materialized value series_fact.
[32m2024-05-31 13:33:24 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - HANDLED_OUTPUT - Handled output "series_fact" using IO manager "delta_lake_arrow_io_manager"
[32m2024-05-31 13:33:24 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - STEP_OUTPUT - Yielded output "metric_fact_wrh" of type "DataFrame". (Type check passed).
[32m2024-05-31 13:33:26 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - ASSET_MATERIALIZATION - Materialized value metric_fact_wrh.
[32m2024-05-31 13:33:26 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - HANDLED_OUTPUT - Handled output "metric_fact_wrh" using IO manager "warehouse_io_manager"
[32m2024-05-31 13:33:26 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - STEP_OUTPUT - Yielded output "series_fact_wrh" of type "DataFrame". (Type check passed).
[32m2024-05-31 13:33:26 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - ASSET_MATERIALIZATION - Materialized value series_fact_wrh.
[32m2024-05-31 13:33:26 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - HANDLED_OUTPUT - Handled output "series_fact_wrh" using IO manager "warehouse_io_manager"
[32m2024-05-31 13:33:26 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 34ffd92f-8f73-4376-8171-4732312f8212 - 436843 - fact_tables - STEP_SUCCESS - Finished execution of step "fact_tables" in 32.97s.

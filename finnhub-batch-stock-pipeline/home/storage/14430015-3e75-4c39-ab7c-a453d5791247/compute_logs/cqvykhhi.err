[32m2024-05-24 23:29:47 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 14430015-3e75-4c39-ab7c-a453d5791247 - 170203 - LOGS_CAPTURED - Started capturing logs in process (pid: 170203).
[32m2024-05-24 23:29:47 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 14430015-3e75-4c39-ab7c-a453d5791247 - 170203 - fact_wrh_tables - STEP_START - Started execution of step "fact_wrh_tables".
[32m2024-05-24 23:29:47 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 14430015-3e75-4c39-ab7c-a453d5791247 - fact_wrh_tables - Loading S3 object from: s3a://dagster-api/staging/2024-05-24/metric
[32m2024-05-24 23:29:52 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 14430015-3e75-4c39-ab7c-a453d5791247 - 170203 - fact_wrh_tables - LOADED_INPUT - Loaded input "metric" using input manager "s3_prqt_io_manager", from output "metric" of step "spark_operator.merge_and_analyze"
[32m2024-05-24 23:29:52 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 14430015-3e75-4c39-ab7c-a453d5791247 - fact_wrh_tables - Loading S3 object from: s3a://dagster-api/staging/2024-05-24/series
[32m2024-05-24 23:29:53 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 14430015-3e75-4c39-ab7c-a453d5791247 - 170203 - fact_wrh_tables - LOADED_INPUT - Loaded input "series" using input manager "s3_prqt_io_manager", from output "series" of step "spark_operator.merge_and_analyze"
[32m2024-05-24 23:29:53 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 14430015-3e75-4c39-ab7c-a453d5791247 - 170203 - fact_wrh_tables - STEP_INPUT - Got input "metric" of type "Any". (Type check passed).
[32m2024-05-24 23:29:53 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 14430015-3e75-4c39-ab7c-a453d5791247 - 170203 - fact_wrh_tables - STEP_INPUT - Got input "series" of type "Any". (Type check passed).
[32m2024-05-24 23:30:13 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 14430015-3e75-4c39-ab7c-a453d5791247 - 170203 - fact_wrh_tables - STEP_OUTPUT - Yielded output "metric_fact" of type "Table". (Type check passed).
[32m2024-05-24 23:30:13 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 14430015-3e75-4c39-ab7c-a453d5791247 - fact_wrh_tables - IO manager mode overridden with the asset metadata mode, overwrite -> append
[32m2024-05-24 23:30:13 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 14430015-3e75-4c39-ab7c-a453d5791247 - fact_wrh_tables - Writing with mode: append
[32m2024-05-24 23:30:14 +0000[0m - dagster - [34mERROR[0m - [31m__ASSET_JOB - 14430015-3e75-4c39-ab7c-a453d5791247 - 170203 - fact_wrh_tables - STEP_FAILURE - Execution of step "fact_wrh_tables" failed.

dagster._core.errors.DagsterExecutionHandleOutputError: Error occurred while handling output "metric_fact" of step "fact_wrh_tables"::

ValueError: Schema of data does not match table schema
Data schema:
10DayAverageTradingVolume: string
13WeekPriceReturnDaily: string
26WeekPriceReturnDaily: string
3MonthADReturnStd: string
3MonthAverageTradingVolume: string
52WeekHigh: string
52WeekHighDate: string
52WeekLow: string
52WeekLowDate: string
52WeekPriceReturnDaily: string
5DayPriceReturnDaily: string
assetTurnoverAnnual: string
assetTurnoverTTM: string
beta: string
bookValuePerShareAnnual: string
bookValuePerShareQuarterly: string
bookValueShareGrowth5Y: string
capexCagr5Y: string
cashFlowPerShareAnnual: string
cashFlowPerShareQuarterly: string
cashFlowPerShareTTM: string
cashPerSharePerShareAnnual: string
cashPerSharePerShareQuarterly: string
currentDividendYieldTTM: string
currentRatioAnnual: string
currentRatioQuarterly: string
dividendPerShareAnnual: string
dividendPerShareTTM: string
ebitdPerShareAnnual: string
ebitdPerShareTTM: string
ebitdaCagr5Y: string
ebitdaInterimCagr5Y: string
enterpriseValue: string
epsAnnual: string
epsBasicExclExtraItemsAnnual: string
epsBasicExclExtraItemsTTM: string
epsExclExtraItemsAnnual: string
epsExclExtraItemsTTM: string
epsGrowth3Y: string
epsGrowth5Y: string
epsGrowthQuarterlyYoy: string
epsGrowthTTMYoy: string
epsInclExtraItemsAnnual: string
epsInclExtraItemsTTM: string
epsNormalizedAnnual: string
epsTTM: string
focfCagr5Y: string
grossMarginAnnual: string
grossMarginTTM: string
inventoryTurnoverTTM: string
longTermDebt/equityAnnual: string
longTermDebt/equityQuarterly: string
marketCapitalization: string
monthToDatePriceReturnDaily: string
netIncomeEmployeeAnnual: string
netIncomeEmployeeTTM: string
netInterestCoverageAnnual: string
netInterestCoverageTTM: string
netProfitMargin5Y: string
netProfitMarginAnnual: string
netProfitMarginTTM: string
operatingMargin5Y: string
operatingMarginAnnual: string
operatingMarginTTM: string
pbAnnual: string
pbQuarterly: string
pcfShareAnnual: string
pcfShareTTM: string
peAnnual: string
peBasicExclExtraTTM: string
peExclExtraTTM: string
peInclExtraTTM: string
peNormalizedAnnual: string
peTTM: string
pretaxMargin5Y: string
pretaxMarginAnnual: string
pretaxMarginTTM: string
priceRelativeToS&P50013Week: string
priceRelativeToS&P50026Week: string
priceRelativeToS&P5004Week: string
priceRelativeToS&P50052Week: string
priceRelativeToS&P500Ytd: string
psAnnual: string
psTTM: string
ptbvAnnual: string
ptbvQuarterly: string
quickRatioAnnual: string
quickRatioQuarterly: string
receivablesTurnoverAnnual: string
receivablesTurnoverTTM: string
revenueEmployeeAnnual: string
revenueEmployeeTTM: string
revenueGrowth3Y: string
revenueGrowth5Y: string
revenueGrowthQuarterlyYoy: string
revenueGrowthTTMYoy: string
revenuePerShareAnnual: string
revenuePerShareTTM: string
revenueShareGrowth5Y: string
roa5Y: string
roaRfy: string
roaTTM: string
roe5Y: string
roeRfy: string
roeTTM: string
roi5Y: string
roiAnnual: string
roiTTM: string
tangibleBookValuePerShareAnnual: string
tangibleBookValuePerShareQuarterly: string
tbvCagr5Y: string
totalDebt/totalEquityAnnual: string
totalDebt/totalEquityQuarterly: string
yearToDatePriceReturnDaily: string
symbol: string
currentEv/freeCashFlowAnnual: string
currentEv/freeCashFlowTTM: string
dividendGrowthRate5Y: string
dividendYieldIndicatedAnnual: string
grossMargin5Y: string
inventoryTurnoverAnnual: string
netMarginGrowth5Y: string
payoutRatioAnnual: string
payoutRatioTTM: string
peExclExtraAnnual: string
pfcfShareAnnual: string
pfcfShareTTM: float
Table Schema:
10DayAverageTradingVolume: string
13WeekPriceReturnDaily: string
26WeekPriceReturnDaily: string
3MonthADReturnStd: string
3MonthAverageTradingVolume: string
52WeekHigh: string
52WeekHighDate: string
52WeekLow: string
52WeekLowDate: string
52WeekPriceReturnDaily: string
5DayPriceReturnDaily: string
assetTurnoverAnnual: string
assetTurnoverTTM: string
beta: string
bookValuePerShareAnnual: string
bookValuePerShareQuarterly: string
bookValueShareGrowth5Y: string
capexCagr5Y: string
cashFlowPerShareAnnual: string
cashFlowPerShareQuarterly: string
cashFlowPerShareTTM: string
cashPerSharePerShareAnnual: string
cashPerSharePerShareQuarterly: string
currentDividendYieldTTM: string
currentEv/freeCashFlowAnnual: string
currentEv/freeCashFlowTTM: string
currentRatioAnnual: string
currentRatioQuarterly: string
dividendGrowthRate5Y: string
dividendPerShareAnnual: string
dividendPerShareTTM: string
dividendYieldIndicatedAnnual: string
ebitdPerShareAnnual: string
ebitdPerShareTTM: string
ebitdaCagr5Y: string
ebitdaInterimCagr5Y: string
enterpriseValue: string
epsAnnual: string
epsBasicExclExtraItemsAnnual: string
epsBasicExclExtraItemsTTM: string
epsExclExtraItemsAnnual: string
epsExclExtraItemsTTM: string
epsGrowth3Y: string
epsGrowth5Y: string
epsGrowthQuarterlyYoy: string
epsGrowthTTMYoy: string
epsInclExtraItemsAnnual: string
epsInclExtraItemsTTM: string
epsNormalizedAnnual: string
epsTTM: string
focfCagr5Y: string
grossMargin5Y: string
grossMarginAnnual: string
grossMarginTTM: string
inventoryTurnoverAnnual: string
inventoryTurnoverTTM: string
longTermDebt/equityAnnual: string
longTermDebt/equityQuarterly: string
marketCapitalization: string
monthToDatePriceReturnDaily: string
netIncomeEmployeeAnnual: string
netIncomeEmployeeTTM: string
netInterestCoverageAnnual: string
netInterestCoverageTTM: string
netMarginGrowth5Y: string
netProfitMargin5Y: string
netProfitMarginAnnual: string
netProfitMarginTTM: string
operatingMargin5Y: string
operatingMarginAnnual: string
operatingMarginTTM: string
payoutRatioAnnual: string
payoutRatioTTM: string
pbAnnual: string
pbQuarterly: string
pcfShareAnnual: string
pcfShareTTM: string
peAnnual: string
peBasicExclExtraTTM: string
peExclExtraAnnual: string
peExclExtraTTM: string
peInclExtraTTM: string
peNormalizedAnnual: string
peTTM: string
pfcfShareAnnual: string
pfcfShareTTM: string
pretaxMargin5Y: string
pretaxMarginAnnual: string
pretaxMarginTTM: string
priceRelativeToS&P50013Week: string
priceRelativeToS&P50026Week: string
priceRelativeToS&P5004Week: string
priceRelativeToS&P50052Week: string
priceRelativeToS&P500Ytd: string
psAnnual: string
psTTM: string
ptbvAnnual: string
ptbvQuarterly: string
quickRatioAnnual: string
quickRatioQuarterly: string
receivablesTurnoverAnnual: string
receivablesTurnoverTTM: string
revenueEmployeeAnnual: string
revenueEmployeeTTM: string
revenueGrowth3Y: string
revenueGrowth5Y: string
revenueGrowthQuarterlyYoy: string
revenueGrowthTTMYoy: string
revenuePerShareAnnual: string
revenuePerShareTTM: string
revenueShareGrowth5Y: string
roa5Y: string
roaRfy: string
roaTTM: string
roe5Y: string
roeRfy: string
roeTTM: string
roi5Y: string
roiAnnual: string
roiTTM: string
tangibleBookValuePerShareAnnual: string
tangibleBookValuePerShareQuarterly: string
tbvCagr5Y: string
totalDebt/totalEquityAnnual: string
totalDebt/totalEquityQuarterly: string
yearToDatePriceReturnDaily: string
symbol: string

Stack Trace:
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster/_core/execution/plan/utils.py", line 54, in op_execution_error_boundary
    yield
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster/_utils/__init__.py", line 468, in iterate_with_context
    next_output = next(iterator)
                  ^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster/_core/execution/plan/execute_step.py", line 800, in _gen_fn
    gen_output = output_manager.handle_output(output_context, output.value)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster/_core/storage/db_io_manager.py", line 147, in handle_output
    handler_metadata = self._handlers_by_type[obj_type].handle_output(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster_deltalake/handler.py", line 95, in handle_output
    write_deltalake(  # type: ignore
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/deltalake/writer.py", line 327, in write_deltalake
    raise ValueError(
[0m

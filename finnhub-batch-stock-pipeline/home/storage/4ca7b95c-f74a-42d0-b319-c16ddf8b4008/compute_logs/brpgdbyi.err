[32m2024-05-31 12:27:15 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 4ca7b95c-f74a-42d0-b319-c16ddf8b4008 - 269507 - LOGS_CAPTURED - Started capturing logs in process (pid: 269507).
[32m2024-05-31 12:27:15 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 4ca7b95c-f74a-42d0-b319-c16ddf8b4008 - 269507 - spark_operator.merge_and_analyze - STEP_RESTARTED - Started re-execution (attempt # 2) of step "spark_operator.merge_and_analyze".
[32m2024-05-31 12:27:15 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 4ca7b95c-f74a-42d0-b319-c16ddf8b4008 - spark_operator.merge_and_analyze - Loading S3 object from: s3a://dagster-api/staging/2024-05-31/spark_operator.create_stock_tables[stock_A]/metric_and_series
[32m2024-05-31 12:27:15 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 4ca7b95c-f74a-42d0-b319-c16ddf8b4008 - 269507 - spark_operator.merge_and_analyze - STEP_UP_FOR_RETRY - Execution of step "spark_operator.merge_and_analyze" failed and has requested a retry in 0.5264259580797608 seconds.

dagster._core.execution.plan.utils.RetryRequestedFromPolicy

Stack Trace:
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster/_core/execution/plan/execute_plan.py", line 282, in dagster_event_sequence_for_step
    for step_event in check.generator(step_events):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster/_core/execution/plan/execute_step.py", line 491, in core_dagster_event_sequence_for_step
    for event_or_input_value in step_input.source.load_input_object(
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster/_core/execution/plan/inputs.py", line 786, in load_input_object
    for event_or_input_value in inner_source.load_input_object(step_context, input_def):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster/_core/execution/plan/inputs.py", line 498, in load_input_object
    yield from _load_input_with_input_manager(input_manager, load_input_context)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster/_core/execution/plan/inputs.py", line 839, in _load_input_with_input_manager
    with op_execution_error_boundary(
  File "/home/gitpod/.pyenv/versions/3.12.3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster/_core/execution/plan/utils.py", line 72, in op_execution_error_boundary
    raise RetryRequestedFromPolicy(

The above exception was caused by the following exception:
AttributeError: 'LazyPySparkResource' object has no attribute 'read'

Stack Trace:
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster/_core/execution/plan/utils.py", line 54, in op_execution_error_boundary
    yield
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster/_core/execution/plan/inputs.py", line 846, in _load_input_with_input_manager
    value = input_manager.load_input(context)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/practical-data-engineering/finnhub-batch-stock-pipeline/finnhub_batch_stock_pipeline/iomanagers/staging_s3_parquet_io_manager.py", line 148, in load_input
    return self.inner_io_manager().load_input(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster/_core/storage/upath_io_manager.py", line 405, in load_input
    return self._load_single_input(path, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dagster/_core/storage/upath_io_manager.py", line 272, in _load_single_input
    obj = self.load_from_path(context=context, path=path)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/practical-data-engineering/finnhub-batch-stock-pipeline/finnhub_batch_stock_pipeline/iomanagers/staging_s3_parquet_io_manager.py", line 73, in load_from_path
    return self.pyspark.read.format("delta").load(pathe)
           ^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/pydantic/main.py", line 767, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')


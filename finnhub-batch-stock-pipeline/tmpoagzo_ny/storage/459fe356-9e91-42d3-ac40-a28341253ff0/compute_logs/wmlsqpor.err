[32m2024-06-15 13:20:49 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 459fe356-9e91-42d3-ac40-a28341253ff0 - 128700 - LOGS_CAPTURED - Started capturing logs in process (pid: 128700).
[32m2024-06-15 13:20:49 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 459fe356-9e91-42d3-ac40-a28341253ff0 - 128700 - spark_operator.create_stock_tables[stock_ABCL] - STEP_START - Started execution of step "spark_operator.create_stock_tables[stock_ABCL]".
[32m2024-06-15 13:20:49 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 459fe356-9e91-42d3-ac40-a28341253ff0 - spark_operator.create_stock_tables[stock_ABCL] - Loading file from: /workspaces/practical-data-engineering/finnhub-batch-stock-pipeline/tmpoagzo_ny/storage/459fe356-9e91-42d3-ac40-a28341253ff0/spark_operator.stock_tables/result/stock_ABCL using PickledObjectFilesystemIOManager...
[32m2024-06-15 13:20:49 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 459fe356-9e91-42d3-ac40-a28341253ff0 - 128700 - spark_operator.create_stock_tables[stock_ABCL] - LOADED_INPUT - Loaded input "input_fn" using input manager "io_manager", from output "result" of step "spark_operator.stock_tables"
[32m2024-06-15 13:20:49 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 459fe356-9e91-42d3-ac40-a28341253ff0 - 128700 - spark_operator.create_stock_tables[stock_ABCL] - STEP_INPUT - Got input "input_fn" of type "Any". (Type check passed).
24/06/15 13:20:50 WARN Utils: Your hostname, codespaces-e7c8c2 resolves to a loopback address: 127.0.0.1; using 172.16.5.4 instead (on interface eth0)
24/06/15 13:20:50 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
24/06/15 13:20:50 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[Stage 0:>                                                          (0 + 4) / 4]                                                                                24/06/15 13:20:58 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
[Stage 1:>                                                          (0 + 4) / 4]                                                                                [32m2024-06-15 13:21:00 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 459fe356-9e91-42d3-ac40-a28341253ff0 - spark_operator.create_stock_tables[stock_ABCL] - Row(10DayAverageTradingVolume=1.67077, 13WeekPriceReturnDaily=-31.2766, 26WeekPriceReturnDaily=-33.6756, 3MonthADReturnStd=44.940758, 3MonthAverageTradingVolume=1.02884, 52WeekHigh=8.04, 52WeekHighDate='2023-07-19', 52WeekLow=3.22, 52WeekLowDate='2024-06-14', 52WeekPriceReturnDaily=-56.8182, 5DayPriceReturnDaily=-7.9772, assetTurnoverAnnual=0.0256, assetTurnoverTTM=0.0239, beta=1.8622186, bookValuePerShareAnnual=3.9622, bookValuePerShareQuarterly=3.8482, capexCagr5Y=71.01, cashFlowPerShareAnnual=-0.4174, cashFlowPerShareQuarterly=-0.4364, cashFlowPerShareTTM=-0.34134, cashPerSharePerShareAnnual=2.6153, cashPerSharePerShareQuarterly=2.3773, currentDividendYieldTTM=None, currentEv/freeCashFlowAnnual=3.60949, currentRatioAnnual=7.3268, currentRatioQuarterly=7.7605, dividendPerShareTTM=None, ebitdPerShareAnnual=-0.6771, ebitdPerShareTTM=-0.6469, ebitdaCagr5Y=None, enterpriseValue=826.2235, epsAnnual=-0.5063, epsBasicExclExtraItemsAnnual=-0.5063, epsBasicExclExtraItemsTTM=-0.5055, epsExclExtraItemsAnnual=-0.5063, epsExclExtraItemsTTM=-0.5055, epsGrowth3Y=None, epsGrowth5Y=None, epsGrowthQuarterlyYoy=None, epsGrowthTTMYoy=None, epsInclExtraItemsAnnual=-0.5063, epsInclExtraItemsTTM=-0.5055, epsNormalizedAnnual=-0.5063, epsTTM=-0.5055, focfCagr5Y=None, longTermDebt/equityAnnual=0.0026, longTermDebt/equityQuarterly=0, marketCapitalization=949.79553, monthToDatePriceReturnDaily=-17.602, netIncomeEmployeeAnnual=-0.2958, netIncomeEmployeeTTM=-0.2967, netInterestCoverageAnnual=75.6061, netInterestCoverageTTM=79.25, netMarginGrowth5Y=None, netProfitMargin5Y=-55.88, netProfitMarginAnnual=-385, netProfitMarginTTM=-407.98, operatingMargin5Y=-98.95, operatingMarginAnnual=-623.82, operatingMarginTTM=-551.48, payoutRatioAnnual=None, pbAnnual=1.4379, pbQuarterly=1.1505, pcfShareAnnual=None, pcfShareTTM=None, peAnnual=None, peBasicExclExtraTTM=None, peExclExtraAnnual=8.87768, peExclExtraTTM=None, peInclExtraTTM=None, peNormalizedAnnual=None, peTTM=None, pfcfShareAnnual=4.6399, pfcfShareTTM=2.7451, pretaxMargin5Y=-60.26, pretaxMarginAnnual=-457.67, pretaxMarginTTM=-429.45, priceRelativeToS&P50013Week=-36.681, priceRelativeToS&P50026Week=-51.62, priceRelativeToS&P5004Week=-13.7814, priceRelativeToS&P50052Week=-79.4526, priceRelativeToS&P500Ytd=-57.6275, psAnnual=24.9782, psTTM=26.5062, ptbvAnnual=1.6057, ptbvQuarterly=1.2856, quickRatioAnnual=7.1418, quickRatioQuarterly=7.5493, receivablesTurnoverAnnual=1.0991, receivablesTurnoverTTM=1.3169, revenueEmployeeAnnual=0.0768, revenueEmployeeTTM=0.0724, revenueGrowth3Y=-45.37, revenueGrowth5Y=34, revenueGrowthQuarterlyYoy=-18.41, revenueGrowthTTMYoy=-80.2, revenuePerShareAnnual=0.1315, revenuePerShareTTM=0.1224, revenueShareGrowth5Y=31.77, roa5Y=2.91, roaRfy=-9.84, roaTTM=-9.790000000000001, roe5Y=1.62, roeRfy=-12.7, roeTTM=-12.61, roi5Y=2.76, roiAnnual=-12.7, roiTTM=-12.61, tangibleBookValuePerShareAnnual=3.5482, tangibleBookValuePerShareQuarterly=3.4438, totalDebt/totalEquityAnnual=0, totalDebt/totalEquityQuarterly=0, yearToDatePriceReturnDaily=-43.4326)
[Stage 7:>                                                          (0 + 4) / 4][Stage 7:==============>                                            (1 + 3) / 4][Stage 7:==============>    (3 + 1) / 4][Stage 8:>                  (0 + 3) / 4][Stage 8:>                                                          (0 + 4) / 4]                                                                                [Stage 17:==============>                                           (1 + 3) / 4]                                                                                [32m2024-06-15 13:21:05 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 459fe356-9e91-42d3-ac40-a28341253ff0 - spark_operator.create_stock_tables[stock_ABCL] - Row(date='2018-12-31', quarterly.assetTurnoverTTM=None, quarterly.bookValue=None, quarterly.cashRatio=None, quarterly.currentRatio=None, quarterly.ebitPerShare=None, quarterly.eps=None, quarterly.ev=None, quarterly.fcfMargin=None, quarterly.fcfPerShareTTM=None, quarterly.longtermDebtTotalAsset=None, quarterly.longtermDebtTotalCapital=None, quarterly.longtermDebtTotalEquity=None, quarterly.netDebtToTotalCapital=None, quarterly.netDebtToTotalEquity=None, quarterly.netMargin=None, quarterly.operatingMargin=None, quarterly.pb=None, quarterly.peTTM=None, quarterly.pfcfTTM=None, quarterly.pretaxMargin=None, quarterly.psTTM=None, quarterly.ptbv=None, quarterly.quickRatio=None, quarterly.receivablesTurnoverTTM=None, quarterly.roaTTM=None, quarterly.roeTTM=None, quarterly.roicTTM=None, quarterly.rotcTTM=None, quarterly.salesPerShare=None, quarterly.tangibleBookValue=None, quarterly.totalDebtToEquity=None, quarterly.totalDebtToTotalAsset=None, quarterly.totalDebtToTotalCapital=None, quarterly.totalRatio=None, annual.bookValue=None, annual.cashRatio=1.625, annual.currentRatio=2.375, annual.ebitPerShare=-0.003, annual.eps=0.0011, annual.ev=None, annual.fcfMargin=None, annual.longtermDebtTotalAsset=None, annual.longtermDebtTotalCapital=None, annual.longtermDebtTotalEquity=None, annual.netDebtToTotalCapital=-0.4667, annual.netDebtToTotalEquity=-0.6034, annual.netMargin=0.0341, annual.operatingMargin=-0.0909, annual.pb=None, annual.pe=None, annual.pfcf=None, annual.pretaxMargin=0.0341, annual.ps=None, annual.ptbv=None, annual.quickRatio=2.2812, annual.receivablesTurnover=None, annual.roa=0.014, annual.roe=0.0259, annual.roic=0.02, annual.rotc=-0.0533, annual.salesPerShare=0.0331, annual.tangibleBookValue=None, annual.totalDebtToEquity=0.2931, annual.totalDebtToTotalAsset=0.1581, annual.totalDebtToTotalCapital=0.2267, annual.totalRatio=2.1717)
24/06/15 13:21:06 WARN GarbageCollectionMetrics: To enable non-built-in garbage collector(s) List(G1 Concurrent GC), users should configure it(them) to spark.eventLog.gcMetrics.youngGenerationGarbageCollectors or spark.eventLog.gcMetrics.oldGenerationGarbageCollectors
[Stage 23:=============================>                            (2 + 2) / 4][Stage 24:==============>                                           (1 + 3) / 4][Stage 26:>                                                         (0 + 4) / 4][Stage 26:===========================================>              (3 + 1) / 4][32m2024-06-15 13:21:15 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 459fe356-9e91-42d3-ac40-a28341253ff0 - 128700 - spark_operator.create_stock_tables[stock_ABCL] - STEP_OUTPUT - Yielded output "metric_and_series" of type "Any". (Type check passed).
[32m2024-06-15 13:21:15 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 459fe356-9e91-42d3-ac40-a28341253ff0 - spark_operator.create_stock_tables[stock_ABCL] - Writing S3 object at: s3a://dagster-api/staging/2024-06-15/spark_operator.create_stock_tables[stock_ABCL]/metric_and_series
[32m2024-06-15 13:21:15 +0000[0m - dagster - [34mWARNING[0m - __ASSET_JOB - 459fe356-9e91-42d3-ac40-a28341253ff0 - spark_operator.create_stock_tables[stock_ABCL] - Removing existing S3 object: staging/2024-06-15/spark_operator.create_stock_tables[stock_ABCL]/metric_and_series
24/06/15 13:21:15 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties
[Stage 37:>                                                         (0 + 4) / 5][Stage 37:===========>                                              (1 + 4) / 5][Stage 37:=======================>                                  (2 + 3) / 5][Stage 37:==============================================>           (4 + 1) / 5]                                                                                [Stage 41:====>                                                    (4 + 4) / 50][Stage 41:=========>                                               (8 + 4) / 50][Stage 41:=================>                                      (16 + 4) / 50][Stage 41:==========================>                             (24 + 4) / 50][Stage 41:===================================>                    (32 + 4) / 50][Stage 41:========================================>               (36 + 4) / 50][Stage 41:=================================================>      (44 + 4) / 50]                                                                                [32m2024-06-15 13:21:23 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 459fe356-9e91-42d3-ac40-a28341253ff0 - 128700 - spark_operator.create_stock_tables[stock_ABCL] - HANDLED_OUTPUT - Handled output "metric_and_series" using IO manager "s3_prqt_io_manager"
[32m2024-06-15 13:21:23 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 459fe356-9e91-42d3-ac40-a28341253ff0 - 128700 - spark_operator.create_stock_tables[stock_ABCL] - STEP_SUCCESS - Finished execution of step "spark_operator.create_stock_tables[stock_ABCL]" in 34.67s.
